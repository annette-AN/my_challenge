<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0,minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, target-densityDpi=device-dpi">
  <!-- (safari) 전화번호 형태로 된 문자열을 전화로 자동호출하지 못하게 함 -->
  <meta name="format-detection" content="telephone=no">

  <!-- favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="resources/images/favicon/favicon.ico">
  <!-- \
   -->
  <link rel="apple-touch-icon" sizes="180x180" href="resources/images/favicon/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="resources/images/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="resources/images/favicon/favicon-16x16.png">
  <link rel="manifest" href="resources/images/favicon/site.webmanifest">
  <link rel="mask-icon" href="resources/images/favicon/safari-pinned-tab.svg" color="#6238a0">
  <meta name="msapplication-TileColor" content="#2b5797">
  <meta name="theme-color" content="#ffffff">

  <!-- css -->
  <link rel="stylesheet" href="resources/css/font.css">
  <link rel="stylesheet" href="resources/css/reset.css">
  <link rel="stylesheet" href="resources/css/teacher_ver_m.css">
  <!-- js -->
  <script type="text/javascript" src="resources/js/jquery-1.11.2.min.js"></script>

  <style>
    .bg_test {
      background:rgba(0,128,0,0.2)!important;
    }
  </style>

  <title>visit timetable</title>
</head>

<body>
  <div id="wrap">
    <div id="header">
      <div class="header_bar">
        <div class="fl">
          <!-- [D] .btn_prev 뒤로가기 버튼에 class="hide"를 붙히면 display: none이 됩니다 -->
          <button type="button" class="btn_prev">
            <img src="resources/images/ico_back.svg" alt="뒤로가기">
          </button>
        </div>
        <h1 class="img_box">
          <img src="resources/images/logo_daekyo_kids.svg" alt="대교 상상 키즈 로고">
        </h1>
        <div class="fr">
          <button type="button" class="gnb_open">
            <img src="resources/images/ico_menu.svg" alt="메뉴 열기">
          </button>
        </div>
      </div>
      <div id="gnb">
        <div class="gnb_box gnb_logo">
          <div class="img_box">
            <img src="resources/images/logo_daekyo_kids.svg" alt="대교 상상 키즈 로고">
          </div>
        </div>

        <div class="gnb_box gnb_card">
          <a href="visit_timetable.html" class="card">
            <img src="resources/images/ico_clock.svg" alt="방문시간표">
            <span class="primary_text primary_text_xs">
              방문시간표
            </span>
          </a>

          <a href="visit_management.html" class="card">
            <img src="resources/images/ico_schedule.svg" alt="방문관리">
            <span class="primary_text primary_text_xs">
              방문관리
            </span>
          </a>

          <a href="schedule_set.html" class="card">
            <img src="resources/images/ico_calendar.svg" alt="스케줄 설정">
            <span class="primary_text primary_text_xs">
              스케줄 설정
            </span>
          </a>

          <a href="#none" class="card">
            <img src="resources/images/ico_folder.svg" alt="정산내역">
            <span class="primary_text primary_text_xs">
              정산내역
            </span>
          </a>

          <a href="#none" class="card">
            <img src="resources/images/ico_list.svg" alt="공지사항">
            <span class="primary_text primary_text_xs">
              공지사항
            </span>
          </a>

          <a href="#none" class="card">
            <img src="resources/images/ico_page.svg" alt="자주묻는 질문">
            <span class="primary_text primary_text_xs">
              자주묻는 질문
            </span>
          </a>
        </div>

        <div class="gnb_box gnb_card">
          <a href="#none" class="card">
            <img src="resources/images/ico_profile.svg" alt="My 프로필">
            <span class="primary_text primary_text_xs">
              My&nbsp;&nbsp;프로필
            </span>
          </a>

          <a href="#none" class="card">
            <img src="resources/images/ico_key.svg" alt="비밀번호 변경">
            <span class="primary_text primary_text_xs">
              비밀번호 변경
            </span>
          </a>

          <a href="#none" class="card">
            <img src="resources/images/ico_logout.svg" alt="로그아웃">
            <span class="primary_text primary_text_xs">
              로그아웃
            </span>
          </a>
        </div>

        <div class="gnb_box">
          <a href="resources/video/sample_video.mp4" class="btn_movie">
            <img src="resources/images/ico_play.svg" alt="영상 바로가기">
            <span class="primary_text primary_text_xs">우동선생님, 이렇게 활동하세요!</span>
          </a>
        </div>
      </div>
    </div>
    <div id="m_container" style="text-align: center;">
      <h1>테스트페이지입니다</h1>
      <select name="" id="" style="width: 200px; height: 40px; border: 1px solid #666; border-radius: 4px;">
        <option value="">1</option>
        <option value="">1</option>
        <option value="">1</option>
        <option value="">1</option>
        <option value="">1</option>
      </select>
    </div>
  </div>

<script type="text/javascript">
  $(document).ready(function(){
    // 공통 gnb 열기/닫기
    $('.gnb_open').on('click', function(e) {
      e.stopPropagation();
      handleGndClose();

      $('body').addClass('gnb_backdrop');
      $('#gnb').addClass('show');

      setTimeout(function () {
        $('#gnb').addClass('on');
      }, 100);

      // gnd 닫기
      function handleGndClose() {
        // gnb에서 클릭 시 버블링 막기
        $('#gnb').on('click', function(e) {
          e.stopPropagation();
        })

        // gnb를 제외한 body를 클릭
        $('body').on('click', function(e) {
          if ($('body').hasClass('gnb_backdrop')) {
            $('#gnb').removeClass('on');
            setTimeout(function () {
              $('#gnb').removeClass('show');
              $('body').removeClass('gnb_backdrop');
            }, 200);
          }
        })
      }
    });

    function timeTableSwipe() {
      // 축약어 Wt = width
      var visibleBoxWt = $('.schedule').innerWidth();
      var targetWt = visibleBoxWt / 3;
      var page = 0;
      var maxPage = 2; //3페이지
      var totalWt = visibleBoxWt * (maxPage + 1);

      $('.schedule_box').css({'width': totalWt + 'px'})
      $('.schedule_box ul').css({'width': targetWt + 'px'})

     $('.schedule_box').on('touchstart', function (e) {
        var startX = e.originalEvent.touches[0].clientX;
        var startY = e.originalEvent.touches[0].clientY;
        var dragX = 0;
        var dragY = 0;
        var positionX = $(this).position().left;
        var direction = '';

        $(document).on('touchmove', timeTableTouchMove);
        $(document).on('touchend', timeTableTouchEnd);

        function timeTableTouchMove(e) {
          dragX = e.originalEvent.touches[0].clientX - startX;
          dragY = e.originalEvent.touches[0].clientY - startY;

          $('body').addClass('prevent_scroll')
          if (direction == '') {
            if (Math.abs(dragX) > Math.abs(dragY)) direction = 'horizontal';
            if (Math.abs(dragY) > Math.abs(dragX)) direction = 'vertical';
          }

          if (direction === 'horizontal') dragY = 0
          if (direction === 'vertical') {
            dragX = 0
            $('body').removeClass('prevent_scroll')
          }
        }

        function timeTableTouchEnd(e) {
          if (direction == 'horizontal') {
            var directionOffset = dragX < -20 ? page += 1 : dragX > 20 ? page += -1 : page += 0;

            if (page < 0) {
              page = 0;
            } else if (page > maxPage) {
              page = maxPage;
            } 

            var move = (-page * visibleBoxWt)
            $('.schedule_box').css({ 'left': move + 'px' });
            $('body').removeClass('prevent_scroll')
          }

          $(document).off('touchmove', timeTableTouchMove);
          $(document).off('touchend', timeTableTouchEnd);
        }
      });

    }
    timeTableSwipe();
  })
</script>
</body>
</html>